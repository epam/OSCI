language: python
python: "3.7"
dist: bionic
stages:
  - pre-test
  - unit-test
  - integration-test
install:
  # MSSQL support, 4 lines
  # until https://github.com/epam/OSCI/issues/2 is fixed
  - docker run -e 'ACCEPT_EULA=Y' -e 'SA_PASSWORD=yourStrong(!)Password' -e 'MSSQL_PID=Express' -p 127.0.0.1:1433:1433 -d mcr.microsoft.com/mssql/server:2017-latest-ubuntu
  - sudo apt-get -y install unixodbc-dev tdsodbc
  - sudo odbcinst -i -d -f /usr/share/tdsodbc/odbcinst.ini

  - pip install -r requirements.txt

  - cp secrets.travis.py osci/secrets.py

jobs:
  include:
    - name: "PyLint test"
        stage: pre-test
        script: pylint osci
    - name: "Unit tests"
      stage: unit-test
      script: python -m pytest test/unit
    - name: "Integration tests"
        stage: integration-test
        script:
          - echo "Skipped til fix https://github.com/epam/OSCI/issues/9"
          # - python -m pytest test/integration